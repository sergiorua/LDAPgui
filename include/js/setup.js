Ext.onReady(function(){Ext.QuickTips.init();Ext.form.Field.prototype.msgTarget='side';Ext.apply(Ext.form.VTypes,{domain:function(value,field){var x=value.match("([a-z]|[0-9])+\.(com|net|uk|us|org)");return(x);},domainText:'Please enter a valid domain',});Ext.apply(Ext.form.VTypes,{password:function(value,field){if(field.initialPasswordField){var pwd=Ext.getCmp(field.initialPasswordField);this.passwordText='Confirmation does not match your initial password entry.';return(value==pwd.getValue());}
passwordText:'Passwords must be at least 8 characters, containing either a number, or a valid special character (!@#$%^&*()-_=+)';var hasSpecial=value.match(/[0-9!@#\$%\^&\*\(\)\-_=\+]+/i);var hasLength=(value.length>=8);return(hasSpecial&&hasLength);},passwordText:'Passwords must be at least 8 characters, containing either a number, or a valid special character (!@#$%^&*()-_=+)',});var server=new Ext.form.TextField({fieldLabel:'Server IP/Host',allowBlank:false,name:'server',emptyText:"my.ldap.server.com",anchor:'90%'});var suffix=new Ext.form.TextField({fieldLabel:'Domain',allowBlank:false,name:'suffix',emptyText:"example.com",vtype:'domain',anchor:'90%'});var adminuser=new Ext.form.TextField({fieldLabel:'Admin User',allowBlank:false,name:'adminuser',value:'cn=Directory Manager',disabled:true,anchor:'90%'});var password=new Ext.form.TextField({fieldLabel:'Admin Password',allowBlank:false,inputType:'password',name:'password',id:'password1',vtype:'password',anchor:'90%'});var password2=new Ext.form.TextField({fieldLabel:'Re-Password',allowBlank:false,inputType:'password',name:'password2',id:'password2',vtype:'password',initialPasswordField:'password1',anchor:'90%'});var ldapMgtSetup=new Ext.FormPanel({bodyStyle:'padding:5px',labelWidth:175,border:false,baseCls:'x-plain',defaults:{bodyStyle:'padding:0px'},url:'/setup/save',method:'POST',items:[server,suffix,adminuser,password,password2,]});var window=new Ext.Window({title:'LDAP Users Management Setup',width:450,height:220,minWidth:300,minHeight:220,plain:true,bodyStyle:'padding:5px;',buttonAlign:'center',closable:false,items:ldapMgtSetup,buttons:[{text:'Done',handler:function(){if(ldapMgtSetup.form.isValid()){ldapMgtSetup.form.submit({waitMsg:'Saving...',failure:function(form,action){Ext.MessageBox.alert('Error',action.result.info);document.location="/login";},success:function(form,action){Ext.MessageBox.alert('Setup',action.result.info);},});}},}]});window.show();});
